<!DOCTYPE html>
<html class="writer-html5" lang="en" >
<head>
  <meta charset="utf-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>analytics_packages.custom_pandas &mdash; kabbes_analytics_packages 0.5.0 documentation</title>
      <link rel="stylesheet" href="../../_static/pygments.css" type="text/css" />
      <link rel="stylesheet" href="../../_static/css/theme.css" type="text/css" />
  <!--[if lt IE 9]>
    <script src="../../_static/js/html5shiv.min.js"></script>
  <![endif]-->
  
        <script data-url_root="../../" id="documentation_options" src="../../_static/documentation_options.js"></script>
        <script src="../../_static/doctools.js"></script>
        <script src="../../_static/sphinx_highlight.js"></script>
    <script src="../../_static/js/theme.js"></script>
    <link rel="index" title="Index" href="../../genindex.html" />
    <link rel="search" title="Search" href="../../search.html" /> 
</head>

<body class="wy-body-for-nav"> 
  <div class="wy-grid-for-nav">
    <nav data-toggle="wy-nav-shift" class="wy-nav-side">
      <div class="wy-side-scroll">
        <div class="wy-side-nav-search" >

          
          
          <a href="../../index.html" class="icon icon-home">
            kabbes_analytics_packages
          </a>
<div role="search">
  <form id="rtd-search-form" class="wy-form" action="../../search.html" method="get">
    <input type="text" name="q" placeholder="Search docs" aria-label="Search docs" />
    <input type="hidden" name="check_keywords" value="yes" />
    <input type="hidden" name="area" value="default" />
  </form>
</div>
        </div><div class="wy-menu wy-menu-vertical" data-spy="affix" role="navigation" aria-label="Navigation menu">
              <p class="caption" role="heading"><span class="caption-text">Contents:</span></p>
<ul>
<li class="toctree-l1"><a class="reference internal" href="../../modules.html">src</a></li>
</ul>

        </div>
      </div>
    </nav>

    <section data-toggle="wy-nav-shift" class="wy-nav-content-wrap"><nav class="wy-nav-top" aria-label="Mobile navigation menu" >
          <i data-toggle="wy-nav-top" class="fa fa-bars"></i>
          <a href="../../index.html">kabbes_analytics_packages</a>
      </nav>

      <div class="wy-nav-content">
        <div class="rst-content">
          <div role="navigation" aria-label="Page navigation">
  <ul class="wy-breadcrumbs">
      <li><a href="../../index.html" class="icon icon-home" aria-label="Home"></a></li>
          <li class="breadcrumb-item"><a href="../index.html">Module code</a></li>
      <li class="breadcrumb-item active">analytics_packages.custom_pandas</li>
      <li class="wy-breadcrumbs-aside">
      </li>
  </ul>
  <hr/>
</div>
          <div role="main" class="document" itemscope="itemscope" itemtype="http://schema.org/Article">
           <div itemprop="articleBody">
             
  <h1>Source code for analytics_packages.custom_pandas</h1><div class="highlight"><pre>
<span></span><span class="sd">&quot;&quot;&quot;</span>
<span class="sd">These are all very outdated, wrote these several years ago. There are probably much better ways to achieve what you need to</span>
<span class="sd">-James</span>
<span class="sd">&quot;&quot;&quot;</span>

<span class="kn">import</span> <span class="nn">pandas</span> <span class="k">as</span> <span class="nn">pd</span>
<span class="kn">import</span> <span class="nn">matplotlib.pyplot</span> <span class="k">as</span> <span class="nn">plt</span>
<span class="kn">import</span> <span class="nn">numpy</span> <span class="k">as</span> <span class="nn">np</span>

<span class="kn">import</span> <span class="nn">collections</span>
<span class="kn">import</span> <span class="nn">datetime</span>
<span class="kn">import</span> <span class="nn">sys</span>
<span class="kn">from</span> <span class="nn">dateutil.relativedelta</span> <span class="kn">import</span> <span class="n">relativedelta</span>
<span class="kn">import</span> <span class="nn">time</span>

<div class="viewcode-block" id="get_df"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.get_df">[docs]</a><span class="k">def</span> <span class="nf">get_df</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Read csv file from local directory: return dataframe&#39;&#39;&#39;</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">read_csv</span><span class="p">(</span><span class="n">file_name</span><span class="p">,</span> <span class="o">**</span><span class="n">params</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="df_change_row_ind_col_value"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.df_change_row_ind_col_value">[docs]</a><span class="k">def</span> <span class="nf">df_change_row_ind_col_value</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">index</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">new_val</span><span class="p">):</span>
    <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">index</span><span class="p">,</span> <span class="n">column</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_val</span>
    <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="value_counts_in_df"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.value_counts_in_df">[docs]</a><span class="k">def</span> <span class="nf">value_counts_in_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>

    <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span></div>

<div class="viewcode-block" id="map_df_column_to_dict"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.map_df_column_to_dict">[docs]</a><span class="k">def</span> <span class="nf">map_df_column_to_dict</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="nb">dict</span><span class="p">,</span> <span class="n">new_col</span><span class="p">):</span>

    <span class="n">df</span><span class="p">[</span><span class="n">new_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">map</span><span class="p">(</span><span class="nb">dict</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span></div>


<div class="viewcode-block" id="move_last_column_to_first"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.move_last_column_to_first">[docs]</a><span class="k">def</span> <span class="nf">move_last_column_to_first</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>

    <span class="n">cols</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="o">.</span><span class="n">tolist</span><span class="p">()</span>
    <span class="n">cols</span> <span class="o">=</span> <span class="n">cols</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">:]</span> <span class="o">+</span> <span class="n">cols</span><span class="p">[:</span><span class="o">-</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span>
    <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="prep_datetime"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.prep_datetime">[docs]</a><span class="k">def</span> <span class="nf">prep_datetime</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">time_col</span><span class="p">,</span> <span class="n">dt_col</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">):</span>

    <span class="n">df</span><span class="p">[</span><span class="n">dt_col</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">time_col</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">strptime</span><span class="p">(</span><span class="n">x</span><span class="p">,</span> <span class="nb">format</span><span class="p">)</span> <span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="fill_nans"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.fill_nans">[docs]</a><span class="k">def</span> <span class="nf">fill_nans</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">value_to_fill</span><span class="p">):</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">fillna</span><span class="p">(</span><span class="n">value_to_fill</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="get_date_and_time"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.get_date_and_time">[docs]</a><span class="k">def</span> <span class="nf">get_date_and_time</span><span class="p">():</span>

    <span class="k">return</span> <span class="n">datetime</span><span class="o">.</span><span class="n">datetime</span><span class="o">.</span><span class="n">fromtimestamp</span><span class="p">(</span><span class="n">time</span><span class="o">.</span><span class="n">time</span><span class="p">())</span><span class="o">.</span><span class="n">strftime</span><span class="p">(</span><span class="s1">&#39;%Y-%m-</span><span class="si">%d</span><span class="s1"> %H:%M:%S&#39;</span><span class="p">)</span></div>

<div class="viewcode-block" id="df_replace"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.df_replace">[docs]</a><span class="k">def</span> <span class="nf">df_replace</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">value_to_change</span><span class="p">,</span> <span class="n">to_fill</span><span class="p">):</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">replace</span><span class="p">(</span><span class="n">value_to_change</span><span class="p">,</span> <span class="n">to_fill</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="and_gate_many_cols"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.and_gate_many_cols">[docs]</a><span class="k">def</span> <span class="nf">and_gate_many_cols</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">col_name</span><span class="p">):</span>

    <span class="n">col1</span> <span class="o">=</span> <span class="n">columns</span><span class="p">[</span><span class="mi">0</span><span class="p">]</span>
    <span class="n">col2</span> <span class="o">=</span> <span class="n">columns</span><span class="p">[</span><span class="mi">1</span><span class="p">]</span>
    <span class="n">cols_added</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)</span> <span class="o">-</span> <span class="mi">2</span><span class="p">):</span>

        <span class="n">bool_num</span> <span class="o">=</span> <span class="s1">&#39;bool&#39;</span> <span class="o">+</span> <span class="nb">str</span><span class="p">(</span><span class="n">i</span><span class="p">)</span>
        <span class="n">join</span> <span class="o">=</span> <span class="n">bool_num</span> <span class="o">+</span> <span class="s1">&#39;: &#39;</span> <span class="o">+</span> <span class="n">col1</span> <span class="o">+</span> <span class="s1">&#39;/&#39;</span> <span class="o">+</span> <span class="n">col2</span>
        <span class="n">cols_added</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">join</span><span class="p">)</span>
        <span class="n">df</span><span class="p">[</span><span class="n">join</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">df</span><span class="p">[</span><span class="n">col2</span><span class="p">]</span>

        <span class="n">col1</span> <span class="o">=</span> <span class="n">join</span>
        <span class="n">col2</span> <span class="o">=</span> <span class="n">columns</span><span class="p">[</span><span class="mi">2</span> <span class="o">+</span> <span class="n">i</span><span class="p">]</span>


    <span class="n">df</span><span class="p">[</span><span class="n">col_name</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">col1</span><span class="p">]</span> <span class="o">&amp;</span> <span class="n">df</span><span class="p">[</span><span class="n">col2</span><span class="p">]</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">drop_these_cols</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cols_added</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;cols added&#39;</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="n">cols_added</span><span class="p">)</span>
    <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;after dropping&#39;</span><span class="p">)</span>
    <span class="c1">#print (df)</span>
    <span class="k">return</span> <span class="n">df</span></div>



<div class="viewcode-block" id="new_df_with_value_in_col"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.new_df_with_value_in_col">[docs]</a><span class="k">def</span> <span class="nf">new_df_with_value_in_col</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">val</span><span class="p">,</span> <span class="n">opposite</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>


    <span class="k">if</span> <span class="ow">not</span> <span class="n">opposite</span><span class="p">:</span>
        <span class="n">new_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="n">val</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">new_df</span>

    <span class="k">if</span> <span class="n">opposite</span><span class="p">:</span>
        <span class="n">new_df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">!=</span> <span class="n">val</span><span class="p">]</span>
        <span class="k">return</span> <span class="n">new_df</span></div>


<div class="viewcode-block" id="split_df_into_equal_time"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.split_df_into_equal_time">[docs]</a><span class="k">def</span> <span class="nf">split_df_into_equal_time</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">time_chunk</span><span class="p">,</span> <span class="n">datetime_col</span><span class="p">,</span> <span class="nb">format</span> <span class="o">=</span> <span class="s1">&#39;seconds&#39;</span><span class="p">):</span>


<span class="w">    </span><span class="sd">&#39;&#39;&#39;returns dfs after being split into separate dfs by a time separator</span>
<span class="sd">    example: starting from time 0, separate into chunks of 3 weeks at a time</span>

<span class="sd">    ISOTIME</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="nb">format</span> <span class="o">==</span> <span class="s1">&#39;minutes&#39;</span><span class="p">:</span>
        <span class="n">time_chunk</span> <span class="o">*=</span> <span class="mi">60</span>
    <span class="k">if</span> <span class="nb">format</span> <span class="o">==</span> <span class="s1">&#39;hours&#39;</span><span class="p">:</span>
        <span class="n">time_chunk</span> <span class="o">*=</span> <span class="mi">3600</span>
    <span class="k">if</span> <span class="nb">format</span> <span class="o">==</span> <span class="s1">&#39;days&#39;</span><span class="p">:</span>
        <span class="n">time_chunk</span> <span class="o">*=</span> <span class="p">(</span><span class="mi">3600</span> <span class="o">*</span> <span class="mi">24</span><span class="p">)</span>
    <span class="k">if</span> <span class="nb">format</span> <span class="o">==</span> <span class="s1">&#39;weeks&#39;</span><span class="p">:</span>
        <span class="n">time_chunk</span> <span class="o">*=</span> <span class="p">(</span><span class="mi">3600</span> <span class="o">*</span> <span class="mi">24</span> <span class="o">*</span> <span class="mi">7</span><span class="p">)</span>

    <span class="n">start_time</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">datetime_col</span><span class="p">]</span>
    <span class="n">end_time</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">datetime_col</span><span class="p">]</span>
    <span class="n">time</span> <span class="o">=</span> <span class="n">start_time</span>
    <span class="n">new_time</span> <span class="o">=</span> <span class="n">start_time</span>

    <span class="n">dfs</span> <span class="o">=</span> <span class="p">[]</span>

    <span class="k">while</span> <span class="n">new_time</span> <span class="o">&lt;</span> <span class="n">end_time</span><span class="p">:</span>

        <span class="c1">#add the respective delta time to the new time</span>
        <span class="k">if</span> <span class="nb">format</span> <span class="o">==</span> <span class="s1">&#39;months&#39;</span><span class="p">:</span>
            <span class="n">new_time</span> <span class="o">=</span> <span class="n">time</span> <span class="o">+</span> <span class="n">relativedelta</span><span class="p">(</span><span class="n">months</span> <span class="o">=</span> <span class="n">time_chunk</span><span class="p">)</span>
        <span class="k">elif</span> <span class="nb">format</span> <span class="o">==</span> <span class="s1">&#39;years&#39;</span><span class="p">:</span>
            <span class="n">new_time</span> <span class="o">=</span> <span class="n">time</span> <span class="o">+</span> <span class="n">relativedelta</span><span class="p">(</span><span class="n">years</span> <span class="o">=</span> <span class="n">time_chunk</span><span class="p">)</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">new_time</span> <span class="o">=</span> <span class="n">time</span> <span class="o">+</span> <span class="n">datetime</span><span class="o">.</span><span class="n">timedelta</span><span class="p">(</span><span class="n">seconds</span> <span class="o">=</span> <span class="n">time_chunk</span><span class="p">)</span>

        <span class="c1">#filter where time &lt; df &lt; new_time</span>
        <span class="n">new_df</span> <span class="o">=</span> <span class="n">filter_df_by_dates</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">datetime_col</span><span class="p">,</span> <span class="n">lower_datetime</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span> <span class="n">upper_datetime</span> <span class="o">=</span> <span class="n">new_time</span><span class="p">,</span> <span class="n">low_inc</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">up_inc</span> <span class="o">=</span> <span class="kc">False</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">new_time</span> <span class="o">&gt;=</span> <span class="n">end_time</span><span class="p">:</span>
            <span class="n">new_df</span> <span class="o">=</span> <span class="n">filter_df_by_dates</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">datetime_col</span><span class="p">,</span> <span class="n">lower_datetime</span> <span class="o">=</span> <span class="n">time</span><span class="p">,</span> <span class="n">upper_datetime</span> <span class="o">=</span> <span class="n">new_time</span><span class="p">,</span> <span class="n">low_inc</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">up_inc</span> <span class="o">=</span> <span class="kc">True</span><span class="p">)</span>

        <span class="n">time</span> <span class="o">=</span> <span class="n">new_time</span>
        <span class="n">dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_df</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dfs</span></div>

<div class="viewcode-block" id="split_by_time_filter"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.split_by_time_filter">[docs]</a><span class="k">def</span> <span class="nf">split_by_time_filter</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">how</span> <span class="o">=</span> <span class="s1">&#39;hours&#39;</span><span class="p">,</span> <span class="n">new_poss_values</span> <span class="o">=</span> <span class="p">[]):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;returns dfs which have been sifted based on hours/days/months etc</span>
<span class="sd">    refer to params.py -&gt; time_splits for reference</span>

<span class="sd">    df1                      df2</span>
<span class="sd">    customer     hour        customer     hour</span>
<span class="sd">    0            0           0            1</span>
<span class="sd">    1            0           1            1</span>
<span class="sd">    2            0           2            1</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">time_splits</span> <span class="o">=</span> <span class="p">{</span><span class="s1">&#39;data_dict&#39;</span><span class="p">:</span> <span class="p">[</span><span class="s1">&#39;possible_values&#39;</span><span class="p">,</span><span class="s1">&#39;xlabels&#39;</span><span class="p">,</span><span class="s1">&#39;df_col&#39;</span><span class="p">],</span>
    <span class="s1">&#39;seconds&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">60</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">60</span><span class="p">)),</span> <span class="s1">&#39;SECOND&#39;</span><span class="p">],</span>
    <span class="s1">&#39;minutes&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">60</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">60</span><span class="p">)),</span> <span class="s1">&#39;MINUTE&#39;</span><span class="p">],</span>
    <span class="s1">&#39;hours&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">24</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">24</span><span class="p">)),</span> <span class="s1">&#39;HOUR&#39;</span><span class="p">],</span>
    <span class="s1">&#39;day_nums&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">32</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span> <span class="mi">32</span><span class="p">)),</span> <span class="s1">&#39;DAY&#39;</span><span class="p">],</span>
    <span class="s1">&#39;days&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">7</span><span class="p">)),</span> <span class="p">[</span><span class="s1">&#39;Monday&#39;</span><span class="p">,</span><span class="s1">&#39;Tuesday&#39;</span><span class="p">,</span><span class="s1">&#39;Wednesday&#39;</span><span class="p">,</span><span class="s1">&#39;Thursday&#39;</span><span class="p">,</span><span class="s1">&#39;Friday&#39;</span><span class="p">,</span><span class="s1">&#39;Saturday&#39;</span><span class="p">,</span><span class="s1">&#39;Sunday&#39;</span><span class="p">],</span> <span class="s1">&#39;WEEKDAY&#39;</span><span class="p">],</span>
    <span class="s1">&#39;weeks&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">53</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">53</span><span class="p">)),</span> <span class="s1">&#39;WEEK&#39;</span><span class="p">],</span>
    <span class="s1">&#39;months&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">1</span><span class="p">,</span><span class="mi">13</span><span class="p">)),</span> <span class="p">[</span><span class="s1">&#39;January&#39;</span><span class="p">,</span> <span class="s1">&#39;February&#39;</span><span class="p">,</span><span class="s1">&#39;March&#39;</span><span class="p">,</span><span class="s1">&#39;April&#39;</span><span class="p">,</span><span class="s1">&#39;May&#39;</span><span class="p">,</span><span class="s1">&#39;June&#39;</span><span class="p">,</span><span class="s1">&#39;July&#39;</span><span class="p">,</span><span class="s1">&#39;August&#39;</span><span class="p">,</span><span class="s1">&#39;September&#39;</span><span class="p">,</span><span class="s1">&#39;October&#39;</span><span class="p">,</span><span class="s1">&#39;November&#39;</span><span class="p">,</span><span class="s1">&#39;December&#39;</span><span class="p">],</span> <span class="s1">&#39;MONTH&#39;</span><span class="p">],</span>
    <span class="s1">&#39;years&#39;</span><span class="p">:</span> <span class="p">[</span><span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)),</span> <span class="nb">list</span><span class="p">(</span><span class="nb">range</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="mi">10000</span><span class="p">)),</span> <span class="s1">&#39;YEAR&#39;</span> <span class="p">]</span>
    <span class="p">}</span>

    <span class="n">possible_values</span> <span class="o">=</span> <span class="n">time_splits</span><span class="p">[</span><span class="n">how</span><span class="p">][</span><span class="mi">0</span><span class="p">]</span> <span class="c1">#list</span>
    <span class="n">xlabels</span> <span class="o">=</span> <span class="n">time_splits</span><span class="p">[</span><span class="n">how</span><span class="p">][</span><span class="mi">1</span><span class="p">]</span> <span class="c1">#list</span>
    <span class="n">how_col</span> <span class="o">=</span> <span class="n">time_splits</span><span class="p">[</span><span class="n">how</span><span class="p">][</span><span class="mi">2</span><span class="p">]</span> <span class="c1">#string</span>

    <span class="n">dfs</span> <span class="o">=</span> <span class="p">[]</span>
    <span class="k">if</span> <span class="n">new_poss_values</span> <span class="o">!=</span> <span class="p">[]:</span>
        <span class="n">possible_values</span> <span class="o">=</span> <span class="n">new_poss_values</span>

    <span class="k">for</span> <span class="n">value</span> <span class="ow">in</span> <span class="n">possible_values</span><span class="p">:</span>

        <span class="n">new_df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span> <span class="n">df</span><span class="p">[</span><span class="n">how_col</span><span class="p">]</span> <span class="o">==</span> <span class="n">value</span>  <span class="p">]</span>
        <span class="n">dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_df</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">dfs</span></div>


<div class="viewcode-block" id="filter_df_by_dates"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.filter_df_by_dates">[docs]</a><span class="k">def</span> <span class="nf">filter_df_by_dates</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">date_col_dt</span><span class="p">,</span> <span class="n">lower_datetime</span><span class="p">,</span> <span class="n">upper_datetime</span><span class="p">,</span> <span class="n">low_inc</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">up_inc</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;takes in a pandas df and returns one being filtered by lower and upper dates&#39;&#39;&#39;</span>

    <span class="n">low</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="mi">0</span><span class="p">],</span> <span class="n">date_col_dt</span> <span class="p">]</span>
    <span class="n">high</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="p">[</span><span class="o">-</span><span class="mi">1</span><span class="p">],</span> <span class="n">date_col_dt</span> <span class="p">]</span>

    <span class="k">if</span> <span class="n">upper_datetime</span> <span class="o">&lt;</span> <span class="n">lower_datetime</span><span class="p">:</span>
        <span class="n">upper_datetime</span><span class="p">,</span> <span class="n">lower_datetime</span> <span class="o">=</span> <span class="n">lower_datetime</span><span class="p">,</span> <span class="n">upper_datetime</span>
        <span class="nb">print</span> <span class="p">(</span><span class="s1">&#39;switching upper and lower datetimes&#39;</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">low_inc</span><span class="p">:</span>
        <span class="n">filtered</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span> <span class="n">df</span><span class="p">[</span><span class="n">date_col_dt</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">lower_datetime</span><span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">filtered</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span> <span class="n">df</span><span class="p">[</span><span class="n">date_col_dt</span><span class="p">]</span> <span class="o">&gt;</span> <span class="n">lower_datetime</span><span class="p">]</span>

    <span class="k">if</span> <span class="n">up_inc</span><span class="p">:</span>
        <span class="n">filtered</span> <span class="o">=</span> <span class="n">filtered</span><span class="p">[</span>  <span class="n">filtered</span><span class="p">[</span><span class="n">date_col_dt</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">upper_datetime</span> <span class="p">]</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">filtered</span> <span class="o">=</span> <span class="n">filtered</span><span class="p">[</span>  <span class="n">filtered</span><span class="p">[</span><span class="n">date_col_dt</span><span class="p">]</span> <span class="o">&lt;</span> <span class="n">upper_datetime</span> <span class="p">]</span>

    <span class="k">return</span> <span class="n">filtered</span></div>

<div class="viewcode-block" id="df_datetime_to_time_cols"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.df_datetime_to_time_cols">[docs]</a><span class="k">def</span> <span class="nf">df_datetime_to_time_cols</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">datetime_col</span> <span class="p">,</span><span class="n">extra</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>

    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;YEAR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">datetime_col</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">year</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;MONTH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">datetime_col</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">month</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;DAY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">datetime_col</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">day</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;HOUR&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">datetime_col</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">hour</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;MINUTE&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">datetime_col</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">minute</span><span class="p">)</span>
    <span class="n">df</span><span class="p">[</span><span class="s1">&#39;SECOND&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">datetime_col</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span><span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">second</span><span class="p">)</span>

    <span class="k">if</span> <span class="n">extra</span><span class="p">:</span>

        <span class="n">df</span><span class="p">[</span><span class="s1">&#39;WEEKDAY&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">datetime_col</span><span class="p">]</span><span class="o">.</span><span class="n">apply</span><span class="p">(</span> <span class="k">lambda</span> <span class="n">x</span><span class="p">:</span> <span class="n">x</span><span class="o">.</span><span class="n">weekday</span><span class="p">()</span> <span class="p">)</span>

    <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="sort_df"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.sort_df">[docs]</a><span class="k">def</span> <span class="nf">sort_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">ascend</span> <span class="o">=</span> <span class="kc">True</span><span class="p">,</span> <span class="n">na_pos</span> <span class="o">=</span> <span class="s1">&#39;last&#39;</span><span class="p">):</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">sort_values</span><span class="p">(</span><span class="n">columns</span><span class="p">,</span> <span class="n">ascending</span> <span class="o">=</span> <span class="n">ascend</span><span class="p">,</span> <span class="n">na_position</span> <span class="o">=</span> <span class="n">na_pos</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span></div>


<div class="viewcode-block" id="map_df_col_to_new_id"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.map_df_col_to_new_id">[docs]</a><span class="k">def</span> <span class="nf">map_df_col_to_new_id</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">new_col_name</span><span class="p">,</span> <span class="n">df2</span><span class="p">,</span> <span class="n">id_col</span><span class="p">,</span> <span class="n">map_col</span><span class="p">):</span>

    <span class="n">map_dict</span> <span class="o">=</span> <span class="n">dict_from_two_columns</span><span class="p">(</span><span class="n">df2</span><span class="p">,</span> <span class="n">id_col</span><span class="p">,</span> <span class="n">map_col</span><span class="p">)</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">map_df_column_to_dict</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">,</span> <span class="n">map_dict</span><span class="p">,</span> <span class="n">new_col_name</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="dict_from_two_columns"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.dict_from_two_columns">[docs]</a><span class="k">def</span> <span class="nf">dict_from_two_columns</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">key_col</span><span class="p">,</span> <span class="n">val_col</span><span class="p">):</span>

    <span class="c1">#In [9]: pd.Series(df.Letter.values,index=df.Position).to_dict()</span>
    <span class="c1">#Out[9]: {1: &#39;a&#39;, 2: &#39;b&#39;, 3: &#39;c&#39;, 4: &#39;d&#39;, 5: &#39;e&#39;}</span>
    <span class="n">a</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">df</span><span class="p">[</span><span class="n">val_col</span><span class="p">]</span><span class="o">.</span><span class="n">values</span><span class="p">,</span> <span class="n">index</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">key_col</span><span class="p">])</span><span class="o">.</span><span class="n">to_dict</span><span class="p">()</span>
    <span class="k">return</span> <span class="n">a</span></div>


<div class="viewcode-block" id="replace_in_df"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.replace_in_df">[docs]</a><span class="k">def</span> <span class="nf">replace_in_df</span><span class="p">(</span><span class="n">dataframe</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">to_find</span><span class="p">,</span> <span class="n">to_replace</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;Replaces list or string &quot;to_find&quot; with list or string &quot;to_replace&quot;</span>
<span class="sd">    Looks up all instances in &quot;column&quot; found in the dataframe and replaces them</span>
<span class="sd">    Returns dataframe&#39;&#39;&#39;</span>

    <span class="k">assert</span> <span class="nb">type</span><span class="p">(</span><span class="n">column</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">to_find</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">to_find</span> <span class="o">=</span> <span class="p">[</span><span class="n">to_find</span><span class="p">]</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">to_find</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">to_replace</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">to_replace</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">to_find</span><span class="p">)</span> <span class="c1">#replace them based on index match</span>
            <span class="c1"># to_find = [&#39;USA&#39;,&#39;GB&#39;] to_replace = [&#39;United States&#39;,&#39;Great Britain&#39;]</span>

        <span class="k">else</span><span class="p">:</span>
            <span class="c1">#in this case all the instances in to_find will be replaced with the string to_replace</span>
            <span class="n">a</span> <span class="o">=</span> <span class="n">to_replace</span>
            <span class="n">to_replace</span> <span class="o">=</span> <span class="p">[</span><span class="n">a</span><span class="p">,</span> <span class="p">]</span> <span class="o">*</span> <span class="nb">len</span><span class="p">(</span><span class="n">to_find</span><span class="p">)</span>

        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">to_find</span><span class="p">)):</span>
            <span class="n">item</span> <span class="o">=</span> <span class="n">to_find</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">replace</span> <span class="o">=</span> <span class="n">to_replace</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>
            <span class="n">dataframe</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span> <span class="n">dataframe</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">==</span> <span class="n">item</span><span class="p">,</span> <span class="n">column</span>  <span class="p">]</span> <span class="o">=</span> <span class="n">replace</span>

    <span class="k">return</span> <span class="n">dataframe</span></div>

<div class="viewcode-block" id="keep_these_cols"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.keep_these_cols">[docs]</a><span class="k">def</span> <span class="nf">keep_these_cols</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cols</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Returns dataframe with columns &#39;cols&#39; &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">cols</span><span class="p">]</span></div>

<div class="viewcode-block" id="drop_these_cols"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.drop_these_cols">[docs]</a><span class="k">def</span> <span class="nf">drop_these_cols</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">cols</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Returns dataframe without columns &#39;cols&#39; &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">cols</span><span class="p">,</span> <span class="n">axis</span> <span class="o">=</span> <span class="mi">1</span><span class="p">)</span></div>

<div class="viewcode-block" id="keep_these_rows"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.keep_these_rows">[docs]</a><span class="k">def</span> <span class="nf">keep_these_rows</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rows</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Returns dataframe with index values contained in &#39;rows&#39; &#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span></div>

<div class="viewcode-block" id="drop_these_rows"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.drop_these_rows">[docs]</a><span class="k">def</span> <span class="nf">drop_these_rows</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">rows</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Returns dataframe without &#39;rows&#39; based on index value&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">df</span><span class="o">.</span><span class="n">drop</span><span class="p">(</span><span class="n">rows</span><span class="p">)</span></div>


<div class="viewcode-block" id="rename_cols"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.rename_cols">[docs]</a><span class="k">def</span> <span class="nf">rename_cols</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">existing</span><span class="p">,</span> <span class="n">new</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;renames cols found in &#39;existing&#39; to match those found in &quot;new&quot; &#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">existing</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">existing</span> <span class="o">=</span> <span class="p">[</span><span class="n">existing</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">new</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">new</span> <span class="o">=</span> <span class="p">[</span><span class="n">new</span><span class="p">]</span>

    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">existing</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">new</span><span class="p">)</span>

    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">existing</span><span class="p">)):</span>
        <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">rename</span><span class="p">(</span><span class="n">index</span> <span class="o">=</span> <span class="nb">str</span><span class="p">,</span> <span class="n">columns</span> <span class="o">=</span> <span class="p">{</span><span class="n">existing</span><span class="p">[</span><span class="n">i</span><span class="p">]</span> <span class="p">:</span> <span class="n">new</span><span class="p">[</span><span class="n">i</span><span class="p">]})</span>

    <span class="k">return</span> <span class="n">df</span></div>


<div class="viewcode-block" id="multiple_filters"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.multiple_filters">[docs]</a><span class="k">def</span> <span class="nf">multiple_filters</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">columns</span><span class="p">,</span> <span class="n">two_dim_list</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;columns = [&#39;Age&#39;,&#39;Name&#39;]</span>
<span class="sd">    two_dim_list = [ [21, 25], [&#39;James&#39;,&#39;Michael&#39;] ]</span>

<span class="sd">    this function sends back the df with age values of 21 and 25 and name values of james and michael</span>
<span class="sd">    &#39;&#39;&#39;</span>

    <span class="n">new_df</span> <span class="o">=</span> <span class="n">df</span>

    <span class="k">for</span> <span class="n">col_num</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">columns</span><span class="p">)):</span>

        <span class="n">col</span> <span class="o">=</span> <span class="n">columns</span><span class="p">[</span><span class="n">col_num</span><span class="p">]</span>
        <span class="n">dfs</span> <span class="o">=</span> <span class="p">[]</span>
        <span class="k">for</span> <span class="n">criteria</span> <span class="ow">in</span> <span class="n">two_dim_list</span><span class="p">[</span><span class="n">col_num</span><span class="p">]:</span>

            <span class="n">df</span> <span class="o">=</span> <span class="n">new_df</span><span class="p">[</span> <span class="n">new_df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span> <span class="o">==</span> <span class="n">criteria</span> <span class="p">]</span>
            <span class="n">dfs</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">df</span><span class="p">)</span>

        <span class="k">if</span> <span class="n">dfs</span> <span class="o">!=</span> <span class="p">[]:</span>
            <span class="n">new_df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">(</span><span class="n">dfs</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">new_df</span></div>

<div class="viewcode-block" id="ceiling_filter"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.ceiling_filter">[docs]</a><span class="k">def</span> <span class="nf">ceiling_filter</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">max_val</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Returns df with values below &#39;max_val&#39; found in &#39;column&#39; &#39;&#39;&#39;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span>  <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&lt;=</span> <span class="n">max_val</span>  <span class="p">]</span>
    <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="floor_filter"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.floor_filter">[docs]</a><span class="k">def</span> <span class="nf">floor_filter</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">min_val</span><span class="p">,</span> <span class="n">column</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Returns df with values above &#39;min_val&#39; found in &#39;column&#39; &#39;&#39;&#39;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span>  <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">&gt;=</span> <span class="n">min_val</span>  <span class="p">]</span>
    <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="boxplot"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.boxplot">[docs]</a><span class="k">def</span> <span class="nf">boxplot</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column_with_values</span><span class="p">,</span> <span class="n">group_by</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;Shows a boxplot values found in &#39;column_with_values&#39; with the option to group by another column&#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">group_by</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">column</span> <span class="o">=</span> <span class="n">column_with_values</span><span class="p">,</span> <span class="n">by</span> <span class="o">=</span> <span class="n">group_by</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">df</span><span class="o">.</span><span class="n">boxplot</span><span class="p">(</span><span class="n">column</span> <span class="o">=</span> <span class="n">column_with_values</span><span class="p">)</span></div>

<div class="viewcode-block" id="add_to_bottom"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.add_to_bottom">[docs]</a><span class="k">def</span> <span class="nf">add_to_bottom</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column_names</span><span class="p">,</span> <span class="n">values</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;Adds to bottom of dataframe based on &#39;column_names&#39; and 2D list &#39;values.&#39; See append_to_df_with_df for appending dfs&#39;&#39;&#39;</span>

    <span class="k">assert</span> <span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">len</span><span class="p">(</span><span class="n">column_names</span><span class="p">)</span>

    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">column_names</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">column_names</span> <span class="o">=</span> <span class="p">[</span><span class="n">column_names</span><span class="p">]</span>
    <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">str</span><span class="p">:</span>
        <span class="n">values</span> <span class="o">=</span> <span class="p">[</span><span class="n">values</span><span class="p">]</span>

    <span class="n">dictionary</span> <span class="o">=</span> <span class="p">{}</span>
    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">values</span><span class="p">)):</span>
        <span class="n">dictionary</span><span class="p">[</span><span class="n">column_names</span><span class="p">[</span><span class="n">i</span><span class="p">]]</span> <span class="o">=</span> <span class="n">values</span><span class="p">[</span><span class="n">i</span><span class="p">]</span>

    <span class="n">df</span> <span class="o">=</span> <span class="n">append_to_df_with_df</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">dict_to_df</span><span class="p">(</span><span class="n">dictionary</span><span class="p">))</span>
    <span class="k">return</span> <span class="n">df</span></div>


<div class="viewcode-block" id="check_column_in_list"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.check_column_in_list">[docs]</a><span class="k">def</span> <span class="nf">check_column_in_list</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="nb">list</span><span class="p">,</span> <span class="n">new_column</span><span class="p">):</span>
<span class="w">    </span><span class="sd">&#39;&#39;&#39;returns a dataframe with a boolean value in new column if the row had one of those value or not&#39;&#39;&#39;</span>

    <span class="n">df</span><span class="p">[</span><span class="n">new_column</span><span class="p">]</span> <span class="o">=</span> <span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="nb">list</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span></div>


<div class="viewcode-block" id="append_to_df_with_df"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.append_to_df_with_df">[docs]</a><span class="k">def</span> <span class="nf">append_to_df_with_df</span><span class="p">(</span><span class="n">og_df</span><span class="p">,</span> <span class="n">new_df</span><span class="p">,</span> <span class="n">reset_ind</span> <span class="o">=</span> <span class="kc">True</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;Appends &#39;og_df&#39; with &#39;new_df&#39; and returns new&#39;&#39;&#39;</span>
    <span class="k">return</span> <span class="n">og_df</span><span class="o">.</span><span class="n">append</span><span class="p">(</span><span class="n">new_df</span><span class="p">,</span> <span class="n">ignore_index</span> <span class="o">=</span> <span class="n">reset_ind</span><span class="p">)</span></div>

<div class="viewcode-block" id="grab_rows_with_certain_values"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.grab_rows_with_certain_values">[docs]</a><span class="k">def</span> <span class="nf">grab_rows_with_certain_values</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">column</span><span class="p">,</span> <span class="n">values</span><span class="p">,</span> <span class="n">return_not_in_values</span> <span class="o">=</span> <span class="kc">False</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;Returns a version of the dataframe where every row in &quot;column&quot; contains a value found in list&quot;values&quot;&#39;&#39;&#39;</span>

    <span class="k">if</span> <span class="n">return_not_in_values</span><span class="p">:</span> <span class="c1">#this means we want only the values that are not contained in the values list</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="c1">#print ( df.loc[~df[column].isin(values)] )</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="o">~</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">values</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">!=</span> <span class="n">values</span><span class="p">]</span>

    <span class="k">else</span><span class="p">:</span> <span class="c1">#only those not in the values list</span>

        <span class="k">if</span> <span class="nb">type</span><span class="p">(</span><span class="n">values</span><span class="p">)</span> <span class="o">==</span> <span class="nb">list</span><span class="p">:</span>
            <span class="c1">#print ( df.loc[df[column].isin(values)] )</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span><span class="o">.</span><span class="n">isin</span><span class="p">(</span><span class="n">values</span><span class="p">)]</span>
        <span class="k">else</span><span class="p">:</span>
            <span class="n">df</span> <span class="o">=</span> <span class="n">df</span><span class="o">.</span><span class="n">loc</span><span class="p">[</span><span class="n">df</span><span class="p">[</span><span class="n">column</span><span class="p">]</span> <span class="o">==</span> <span class="n">values</span><span class="p">]</span>


    <span class="k">return</span> <span class="n">df</span></div>


<div class="viewcode-block" id="get_unique_values"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.get_unique_values">[docs]</a><span class="k">def</span> <span class="nf">get_unique_values</span><span class="p">(</span><span class="n">df</span><span class="p">,</span> <span class="n">col</span><span class="p">):</span>
    <span class="k">return</span> <span class="n">df</span><span class="p">[</span><span class="n">col</span><span class="p">]</span><span class="o">.</span><span class="n">unique</span><span class="p">()</span></div>


<div class="viewcode-block" id="dict_to_df"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.dict_to_df">[docs]</a><span class="k">def</span> <span class="nf">dict_to_df</span><span class="p">(</span><span class="n">dictionary</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;Return a dataframe from &#39;dictionary&#39; &#39;&#39;&#39;</span>
    <span class="n">df</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">dictionary</span><span class="p">)</span>
    <span class="k">return</span> <span class="n">df</span></div>

<div class="viewcode-block" id="value_counts_df"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.value_counts_df">[docs]</a><span class="k">def</span> <span class="nf">value_counts_df</span><span class="p">(</span><span class="n">original_dataframe</span><span class="p">,</span> <span class="n">column</span> <span class="o">=</span> <span class="kc">None</span><span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;This function outputs a dataframe with counts of the unique values for each column from the input dataframe (function argument).</span>
<span class="sd">    The counts are given for each column of the input dataframe - in the output a column with</span>
<span class="sd">    unique values is paired with another column with the counts for the unique values&#39;&#39;&#39;</span>
    <span class="n">df_dict</span> <span class="o">=</span> <span class="nb">dict</span><span class="p">()</span>
    <span class="k">if</span> <span class="n">column</span> <span class="o">==</span> <span class="kc">None</span><span class="p">:</span>
        <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">original_dataframe</span><span class="o">.</span><span class="n">columns</span><span class="p">:</span>
            <span class="n">series_value_counts</span> <span class="o">=</span> <span class="n">original_dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
            <span class="n">dict_value_key</span> <span class="o">=</span> <span class="n">series_value_counts</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s2">&quot;_value&quot;</span>
            <span class="n">dict_count_key</span> <span class="o">=</span> <span class="n">series_value_counts</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s2">&quot;_count&quot;</span>
            <span class="n">df_dict</span><span class="p">[</span><span class="n">dict_value_key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">series_value_counts</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
            <span class="n">df_dict</span><span class="p">[</span><span class="n">dict_count_key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">series_value_counts</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>
    <span class="k">else</span><span class="p">:</span>
        <span class="n">i</span> <span class="o">=</span> <span class="n">column</span>
        <span class="n">series_value_counts</span> <span class="o">=</span> <span class="n">original_dataframe</span><span class="p">[</span><span class="n">i</span><span class="p">]</span><span class="o">.</span><span class="n">value_counts</span><span class="p">()</span>
        <span class="n">dict_value_key</span> <span class="o">=</span> <span class="n">series_value_counts</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s2">&quot;_value&quot;</span>
        <span class="n">dict_count_key</span> <span class="o">=</span> <span class="n">series_value_counts</span><span class="o">.</span><span class="n">name</span><span class="o">+</span><span class="s2">&quot;_count&quot;</span>
        <span class="n">df_dict</span><span class="p">[</span><span class="n">dict_value_key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">series_value_counts</span><span class="o">.</span><span class="n">index</span><span class="p">)</span>
        <span class="n">df_dict</span><span class="p">[</span><span class="n">dict_count_key</span><span class="p">]</span> <span class="o">=</span> <span class="nb">list</span><span class="p">(</span><span class="n">series_value_counts</span><span class="o">.</span><span class="n">values</span><span class="p">)</span>

    <span class="k">return</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">collections</span><span class="o">.</span><span class="n">OrderedDict</span><span class="p">([(</span><span class="n">key</span><span class="p">,</span><span class="n">pd</span><span class="o">.</span><span class="n">Series</span><span class="p">(</span><span class="n">values</span><span class="p">))</span> <span class="k">for</span> <span class="n">key</span><span class="p">,</span><span class="n">values</span> <span class="ow">in</span> <span class="n">df_dict</span><span class="o">.</span><span class="n">items</span><span class="p">()]))</span></div>


<div class="viewcode-block" id="histogram"><a class="viewcode-back" href="../../analytics_packages.html#analytics_packages.custom_pandas.histogram">[docs]</a><span class="k">def</span> <span class="nf">histogram</span><span class="p">(</span> <span class="n">two_dim_list</span><span class="p">,</span> <span class="n">x_axis_titles</span><span class="p">,</span> <span class="n">legend_labels</span><span class="p">,</span> <span class="n">x_label</span><span class="p">,</span> <span class="n">y_label</span><span class="p">,</span> <span class="n">graph_title</span><span class="p">,</span> <span class="n">text_size</span> <span class="o">=</span> <span class="mi">11</span><span class="p">,</span> <span class="n">axesfont</span> <span class="o">=</span> <span class="mi">26</span><span class="p">,</span> <span class="n">titlesize</span> <span class="o">=</span> <span class="mi">32</span><span class="p">,</span> <span class="n">opacity</span> <span class="o">=</span> <span class="mf">.6</span>  <span class="p">):</span>

<span class="w">    </span><span class="sd">&#39;&#39;&#39;Prints a histogram: two_dim_list variable should contain n-number (number of differnt colored series to plot) of lists of numerical values l-length long.</span>
<span class="sd">    x_axis_titles is a list of strings l-length long</span>
<span class="sd">    legend labels is a list of strings to the number of lists contained in two_dim_list</span>
<span class="sd">    ex: two_dim_list = [ [.1, .4, .3, .2], [.2, .4, .3, .1], [.2, .3, .3, .2] ], x_axis_titles = [&#39;Pepperoni&#39;,&#39;Sausage&#39;,&#39;Cheese&#39;,&#39;Vegetable&#39;], legend_labels = [&#39;under 20 years old&#39;,&#39;20-50&#39;,&#39;50+&#39;]</span>
<span class="sd">    &#39;&#39;&#39;</span>


    <span class="n">division_list</span> <span class="o">=</span> <span class="n">two_dim_list</span>
    <span class="n">all_col</span> <span class="o">=</span> <span class="n">x_axis_titles</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">style</span><span class="o">.</span><span class="n">use</span><span class="p">(</span><span class="s1">&#39;ggplot&#39;</span><span class="p">)</span>

    <span class="n">n_groups</span> <span class="o">=</span> <span class="nb">len</span><span class="p">(</span><span class="n">all_col</span><span class="p">)</span>
    <span class="n">x_index_list</span> <span class="o">=</span> <span class="n">all_col</span>
    <span class="n">x_axis_ticklabels</span> <span class="o">=</span> <span class="n">all_col</span>

    <span class="n">fig</span><span class="p">,</span> <span class="n">ax</span> <span class="o">=</span> <span class="n">plt</span><span class="o">.</span><span class="n">subplots</span><span class="p">()</span>
    <span class="n">index</span> <span class="o">=</span> <span class="n">np</span><span class="o">.</span><span class="n">arange</span><span class="p">(</span><span class="n">n_groups</span><span class="p">)</span>

    <span class="n">bar_width</span> <span class="o">=</span> <span class="p">(</span> <span class="mi">1</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">division_list</span><span class="p">)</span> <span class="p">)</span> <span class="o">-</span> <span class="p">(</span> <span class="mf">.1</span> <span class="o">/</span> <span class="nb">len</span><span class="p">(</span><span class="n">division_list</span><span class="p">)</span> <span class="p">)</span>
    <span class="n">colors</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;r&#39;</span><span class="p">,</span><span class="s1">&#39;g&#39;</span><span class="p">,</span><span class="s1">&#39;b&#39;</span><span class="p">,</span><span class="s1">&#39;c&#39;</span><span class="p">,</span><span class="s1">&#39;y&#39;</span><span class="p">]</span>


    <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="nb">range</span><span class="p">(</span><span class="nb">len</span><span class="p">(</span><span class="n">division_list</span><span class="p">)):</span>

        <span class="n">a</span> <span class="o">=</span> <span class="n">ax</span><span class="o">.</span><span class="n">bar</span><span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="n">bar_width</span> <span class="o">*</span> <span class="n">i</span><span class="p">,</span> <span class="n">division_list</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">bar_width</span><span class="p">,</span> <span class="n">alpha</span> <span class="o">=</span> <span class="n">opacity</span><span class="p">,</span> <span class="n">color</span> <span class="o">=</span> <span class="n">colors</span><span class="p">[</span><span class="n">i</span><span class="p">],</span> <span class="n">label</span> <span class="o">=</span> <span class="n">legend_labels</span><span class="p">[</span><span class="n">i</span><span class="p">])</span>


    <span class="n">plt</span><span class="o">.</span><span class="n">xlabel</span><span class="p">(</span><span class="n">x_label</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="n">axesfont</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">ylabel</span><span class="p">(</span><span class="n">y_label</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="n">axesfont</span><span class="p">)</span>
    <span class="n">plt</span><span class="o">.</span><span class="n">suptitle</span><span class="p">(</span><span class="n">graph_title</span><span class="p">,</span> <span class="n">weight</span> <span class="o">=</span> <span class="s1">&#39;bold&#39;</span><span class="p">,</span> <span class="n">fontsize</span> <span class="o">=</span> <span class="n">titlesize</span> <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticks</span><span class="p">(</span><span class="n">index</span> <span class="o">+</span> <span class="n">bar_width</span> <span class="o">/</span> <span class="mi">2</span><span class="p">)</span>
    <span class="k">for</span> <span class="n">tick</span> <span class="ow">in</span> <span class="n">ax</span><span class="o">.</span><span class="n">xaxis</span><span class="o">.</span><span class="n">get_major_ticks</span><span class="p">():</span>
        <span class="n">tick</span><span class="o">.</span><span class="n">label</span><span class="o">.</span><span class="n">set_fontsize</span><span class="p">(</span><span class="n">text_size</span><span class="p">)</span>

    <span class="c1">#for i in range(len(x_axis_ticklabels)):</span>
    <span class="c1">#    x_axis_ticklabels[i] = &#39;\n&#39;.join(x_axis_ticklabels[i].split(&#39;:&#39;))</span>

    <span class="n">ax</span><span class="o">.</span><span class="n">set_xticklabels</span><span class="p">(</span> <span class="n">x_axis_ticklabels</span> <span class="p">)</span>
    <span class="n">ax</span><span class="o">.</span><span class="n">legend</span><span class="p">()</span>

    <span class="n">plt</span><span class="o">.</span><span class="n">show</span><span class="p">()</span></div>
</pre></div>

           </div>
          </div>
          <footer>

  <hr/>

  <div role="contentinfo">
    <p>&#169; Copyright 2023, James Kabbes.</p>
  </div>

  Built with <a href="https://www.sphinx-doc.org/">Sphinx</a> using a
    <a href="https://github.com/readthedocs/sphinx_rtd_theme">theme</a>
    provided by <a href="https://readthedocs.org">Read the Docs</a>.
   

</footer>
        </div>
      </div>
    </section>
  </div>
  <script>
      jQuery(function () {
          SphinxRtdTheme.Navigation.enable(true);
      });
  </script> 

</body>
</html>